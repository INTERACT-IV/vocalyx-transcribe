# =====================================================================
# Vocalyx Transcribe - Configuration File
# =====================================================================

[CORE]
# Nom unique de cette instance de worker
instance_name = worker-01

[API]
# URL de vocalyx-api pour communiquer
# En local: http://localhost:8000
# En Docker: http://vocalyx-api:8000
url = http://localhost:8000

# Timeout des requêtes HTTP (en secondes)
timeout = 60

[CELERY]
# Configuration Celery (DOIT correspondre à vocalyx-api)
broker_url = redis://localhost:6379/0
result_backend = redis://localhost:6379/0

[WHISPER]
# Modèle Whisper à utiliser
# Options: tiny, base, small, medium, large-v2, large-v3
# Recommandé: small (bon équilibre vitesse/qualité)
model = ./models/openai-whisper-small

# Device de calcul
# Options: cpu, cuda (GPU NVIDIA), auto
device = cpu

# Type de calcul
# Options: int8, int8_float16, float16, float32
# int8: Le plus rapide (CPU uniquement)
# float16: Bon équilibre (GPU)
compute_type = int8

# Nombre de threads CPU pour l'inférence
# Recommandé: nombre de cœurs CPU - 2
cpu_threads = 8

# Langue par défaut (forcer la langue accélère la transcription)
# Options: fr, en, es, de, it, pt, nl, etc.
# Laisser vide pour détection automatique
language = fr

[PERFORMANCE]
# Nombre de workers Celery (concurrence)
# Celery gère la concurrence, ne pas confondre avec l'ancien max_workers
# Recommandé: entre 1 et 4 selon votre CPU/GPU
max_workers = 2

# Longueur des segments audio en millisecondes
# Pour audios longs, ils seront découpés en segments de cette taille
segment_length_ms = 45000

# Activer VAD (Voice Activity Detection)
# true: Ignore les silences = plus rapide
vad_enabled = true

# Beam size pour le décodage (qualité vs vitesse)
# Plus élevé = meilleure qualité mais plus lent
# Recommandé: 5
beam_size = 5

# Temperature pour le sampling
# 0.0 = déterministe (recommandé)
temperature = 0.0

[PATHS]
# Répertoire partagé pour les uploads (DOIT être identique à vocalyx-api)
upload_dir = /app/shared_uploads

[VAD]
# VAD (Voice Activity Detection) - Paramètres avancés

# Durée minimum de silence pour considérer une pause (en ms)
min_silence_len = 500

# Seuil de silence en dB
# Plus négatif = plus sensible
# Recommandé: -40
silence_thresh = -40

# Seuil VAD pour faster-whisper (0.0-1.0)
# Recommandé: 0.5
vad_threshold = 0.5

# Durée minimum de parole pour être considérée (en ms)
min_speech_duration_ms = 250

# Durée minimum de silence entre segments (en ms)
min_silence_duration_ms = 500

[LOGGING]
# Niveau de log: DEBUG, INFO, WARNING, ERROR, CRITICAL
level = INFO

# Activer les logs dans un fichier
file_enabled = true

# Chemin du fichier de log
file_path = logs/vocalyx-transcribe.log

# Activer les couleurs dans la console
colored = true

[SECURITY]
# Clé secrète pour la communication avec l'API (DOIT être identique à vocalyx-api)
# ⚠️ CHANGER CETTE VALEUR EN PRODUCTION
internal_api_key = CHANGE_ME_SECRET_INTERNAL_KEY_12345