# =====================================================================
# Vocalyx Configuration File
# =====================================================================

[CORE]
# Nom unique de cette instance de worker
instance_name = worker-01

[WHISPER]
# Modèle Whisper à utiliser
# Options: tiny, base, small, medium, large-v2, large-v3
# tiny: Le plus rapide, moins précis (1GB RAM, ~32x temps réel)
# base: Rapide, précision correcte (1GB RAM, ~16x temps réel)
# small: Bon équilibre (2GB RAM, ~6x temps réel) ⭐ RECOMMANDÉ
# medium: Très précis, plus lent (5GB RAM, ~2x temps réel)
# large-v3: Le plus précis, très lent (10GB RAM, ~1x temps réel)
model = ./models/openai-whisper-small

# Device de calcul
# Options: cpu, cuda (GPU NVIDIA), auto
device = cpu

# Type de calcul
# Options: int8, int8_float16, float16, float32
# int8: Le plus rapide, moins précis (CPU uniquement)
# float16: Bon équilibre (GPU)
# float32: Le plus précis (CPU/GPU)
compute_type = int8

# Nombre de threads CPU pour l'inférence
# Recommandé: nombre de cœurs CPU - 2
cpu_threads = 8

# Langue par défaut (forcer la langue accélère la transcription)
# Options: fr, en, es, de, it, pt, nl, etc.
# Laisser vide pour détection automatique
language = fr


[PERFORMANCE]
# Nombre de workers pour le traitement parallèle
# Recommandé: entre 2 et 8 selon votre CPU
# Plus = plus rapide mais plus de RAM utilisée
max_workers = 2

# Longueur des segments audio en millisecondes
# Pour audios longs, ils seront découpés en segments de cette taille
# 60000ms = 1 minute par segment
# Valeurs recommandées: 45000-90000
segment_length_ms = 45000

# Activer VAD (Voice Activity Detection)
# true: Ignore les silences = plus rapide + segments plus pertinents
# false: Transcrit tout l'audio
vad_enabled = true

# Beam size pour le décodage (qualité vs vitesse)
# Plus élevé = meilleure qualité mais plus lent
# Recommandé: 5 (équilibre), max: 10
beam_size = 5

# Temperature pour le sampling
# 0.0 = déterministe (recommandé pour vitesse)
# 0.0-1.0 = plus de variabilité
temperature = 0.0


[LIMITS]
# Taille maximale des fichiers uploadés (en MB)
max_file_size_mb = 100

# Limite de requêtes par minute (rate limiting)
# Protection contre les abus
rate_limit_per_minute = 10

# Extensions de fichiers autorisées (séparées par des virgules)
allowed_extensions = wav,mp3,m4a,flac,ogg,webm


[PATHS]
# Répertoire pour les uploads temporaires
upload_dir = /home/shinohk/code/vocalyx-all/shared_uploads

# Chemin de la base de données SQLite
# Format: sqlite:///./chemin/vers/db.db
database_path = postgresql://postgres:toto@192.168.1.234:5432/vocalyx_db

# Répertoire des templates HTML
templates_dir = templates


[VAD]
# VAD (Voice Activity Detection) - Paramètres avancés
# Ces paramètres affectent la détection de parole avec pydub

# Durée minimum de silence pour considérer une pause (en ms)
# Plus élevé = segments plus longs
# Recommandé: 300-700
min_silence_len = 500

# Seuil de silence en dB
# Plus négatif = plus sensible (détecte plus de silences)
# Recommandé: -35 à -45
# -30: Très peu sensible (garde beaucoup de bruit)
# -40: Équilibré ⭐
# -50: Très sensible (risque de couper des mots)
silence_thresh = -40

# Seuil VAD pour faster-whisper (0.0-1.0)
# Plus élevé = plus strict sur la détection de parole
# Recommandé: 0.5
vad_threshold = 0.5

# Durée minimum de parole pour être considérée (en ms)
# Évite les faux positifs (bruits courts)
min_speech_duration_ms = 250

# Durée minimum de silence entre segments (en ms)
# Évite de fragmenter la parole continue
min_silence_duration_ms = 500


[LOGGING]
# Configuration du logging

# Niveau de log
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
level = INFO

# Activer les logs dans un fichier
# true = logs dans logs/vocalyx.log
# false = logs uniquement en console
file_enabled = true

# Chemin du fichier de log (si file_enabled = true)
file_path = logs/vocalyx.log

# Activer les couleurs dans la console (terminal)
# Rend les logs plus lisibles en développement
colored = true

# ❗️ NOUVEAU
[SECURITY]
# Clé secrète partagée pour la communication Dashboard <-> Worker
# DOIT être identique sur le dashboard et tous les workers
internal_api_key = secret_key_pour_comms_internes_123456